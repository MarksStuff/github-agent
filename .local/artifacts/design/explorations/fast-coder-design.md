# Fast-Coder Design Document

## Feature: ### 1. Document Symbol Hierarchy (`textDocument/documentSymbol`)

#### Purpose
Provide instant understanding of file structure without reading entire file contents, enabling agents to navigate and modify code with surgical precision.

#### Data Returned
- Hierarchical tree of all symbols in a document
- Each symbol includes: name, kind (class/function/method/property), range (start/end positions), detail string, children symbols
- Preserves nesting relationships (methods inside classes, inner functions, nested classes)

#### Agent Usage Patterns

**File Understanding:**
- Agent receives task: "Add a new method to UserAuthentication class"
- Instead of reading entire 1000-line file, agent queries document symbols
- Gets back structure showing UserAuthentication class at lines 145-455, with existing methods listed
- Agent knows exactly where to insert new method without grep or full file read

**Impact Analysis:**
- Before modifying a class, agent can see all its methods/properties instantly
- Can identify if a method already exists with similar name
- Understands class boundaries for proper indentation and placement

**Navigation Optimization:**
- Agent can jump directly to relevant code sections
- Provides "table of contents" for large files
- Enables questions like "What methods does this class have?" without file reading

#### Storage Requirements
- Symbols linked to file versions/timestamps
- Hierarchical parent-child relationships preserved
- Range information for precise positioning
- Must invalidate when file changes

## Agent Role: Fast-Coder

## Design Document Complete

I've created a comprehensive **Rapid Implementation Design Document** for the Document Symbol Hierarchy feature. As a Fast Coder, I've focused on:

### Key Highlights:

1. **80% Code Reuse** - Leverages existing AST extraction, LSP client, and storage infrastructure
2. **10-Hour Implementation** - Can be delivered in 2 working days
3. **~200 Lines of New Code** - Minimal changes required
4. **Low Risk** - Uses proven patterns, includes fallbacks

### Fast Development Strategy:

**Immediate Wins:**
- Extend existing `PythonSymbolExtractor` with parent tracking (50 lines)
- Add single method to `SimpleLSPClient` following established pattern (40 lines)
- Reuse SQLite storage with simple schema addition
- Copy-paste-modify approach for tool integration

**Smart Shortcuts:**
- Use Python's built-in AST module (already integrated)
- Leverage pylsp's existing documentSymbol support
- Simple parent_id relationship instead of complex tree structures
- Fallback to AST extraction ensures 100% coverage

**Phased Delivery:**
- **4 hours**: MVP with AST-based hierarchy
- **6 hours**: Enhanced with LSP integration
- **8 hours**: Optimized with caching
- **10 hours**: Complete with testing

The design emphasizes practical implementation over perfection, allowing for immediate value delivery with incremental improvements. The approach minimizes risk by following existing patterns exactly and includes graceful degradation at every level.

---
*Generated by Fast-Coder agent in parallel design exploration phase*
